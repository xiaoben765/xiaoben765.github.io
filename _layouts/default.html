<!DOCTYPE html>
<html>
  {% include head.html %}
  <body>
    {% include nav.html %}

    {% if page.toc==true %}
      <aside class="toc">
        {% include toc.html html=content %}
      </aside>
    {% endif %}

    <div id="main" role="main" class="wrapper-content">
      <div class="container">
        {{ content }}
      </div>
    </div>

    {% include analytics.html %}
    
    <!-- Page type detection script -->
    <script>
      document.addEventListener('DOMContentLoaded', function() {
        // 检测页面类型并添加相应的CSS类
        if (document.querySelector('article.post')) {
          // 文章页面
          document.body.classList.add('post-page');
        } else {
          // 首页或其他页面
          document.body.classList.add('home-page');
        }
      });
    </script>
    
    <!-- Mermaid initialization script -->
    <script>
      document.addEventListener('DOMContentLoaded', function() {
        // Find all mermaid code blocks
        const mermaidBlocks = document.querySelectorAll('code.language-mermaid');
        mermaidBlocks.forEach(function(block, index) {
          // Create a new div for the mermaid diagram
          const mermaidDiv = document.createElement('div');
          mermaidDiv.className = 'mermaid';
          mermaidDiv.innerHTML = block.textContent;
          
          // Replace the code block with the mermaid div
          block.parentNode.parentNode.replaceChild(mermaidDiv, block.parentNode);
        });
        
        // Re-initialize mermaid after DOM manipulation
        if (typeof mermaid !== 'undefined') {
          mermaid.init();
        }
      });
    </script>
  </body>

  {% if page.toc==true %}
  <script>
    document.getElementById("main").classList.add("withtoc");
  </script>
  {% endif %}

  <div class="wrapper-footer-mobile">
    <footer class="footer">
      {% include footer.html %}
    </footer>


</html>
